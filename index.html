<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>360 QC Review Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      background: #f9f9f9;
    }
    h2 {
      color: #333;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: #fff;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
    button {
      padding: 8px 14px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
  </style>
</head>
<body>

  <h2>360 QC Review Dashboard</h2>

  <table id="qc-table">
    <tr>
      <th>Spin ID</th>
      <th>SKU ID</th>
      <th>Enterprise</th>
      <th>QC</th>
      <th>Issue</th>
      <th>Submit</th>
    </tr>
    <tr>
      <td>spin-001</td>
      <td>sku-001</td>
      <td>Spyne</td>
      <td>john.doe@spyne.ai</td>
      <td>Blurry angle</td>
      <td><button onclick="submitToGoogleForm(this)">Submit</button></td>
    </tr>
    <tr>
      <td>spin-002</td>
      <td>sku-002</td>
      <td>Promotion Pix</td>
      <td>jane.doe@spyne.ai</td>
      <td>Incorrect shadow</td>
      <td><button onclick="submitToGoogleForm(this)">Submit</button></td>
    </tr>
  </table>

  <script>
    function submitToGoogleForm(button) {
      const row = button.closest('tr');
      const spinId = row.cells[0].innerText.trim();
      const skuId = row.cells[1].innerText.trim();
      const enterprise = row.cells[2].innerText.trim();
      const qc = row.cells[3].innerText.trim();
      const issue = row.cells[4].innerText.trim();

      const form = document.createElement("form");
      form.action = "https://docs.google.com/forms/d/e/1FAIpQLSeQH6R9-rYr1Kh2rwUBKu7uGvJAkRrvx8fnxF6jfkac7sNL2A/formResponse";
      form.method = "POST";
      form.target = "hidden_iframe";

      form.innerHTML = `
        <input name="entry.1125049159" value="${spinId}">
        <input name="entry.703277665" value="${skuId}">
        <input name="entry.1815472287" value="${enterprise}">
        <input name="entry.582537694" value="${qc}">
        <input name="entry.575622617" value="${issue}">
      `;

      document.body.appendChild(form);
      form.submit();
      document.body.removeChild(form);

      button.disabled = true;
      button.innerText = "Submitted";
      alert("Submitted to Google Sheet!");
    }
  </script>

  <iframe name="hidden_iframe" style="display:none;"></iframe>

</body>
</html>
